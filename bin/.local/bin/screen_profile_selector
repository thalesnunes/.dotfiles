#!/usr/bin/env bash

if [ "$1" == "-h" ]; then
    echo "-p for printing active monitors"
fi

active_monitors=$(swaymsg -t get_outputs | jq  -r '.[] | select(.dpms and .active) | "\(.make) \(.model) \(.serial)\\t\(.name)"')
monitor_names=$(echo -e "$active_monitors" | cut -f1 | sort | xargs)
monitor_ids=$(echo -e "$active_monitors" | cut -f2 | sort | xargs)

if [ "$1" == "-p" ]; then
    echo -e "Active monitors:\n$active_monitors"
    echo
    echo "Monitor names: $monitor_names"
    echo
    echo "Monitor IDs: $monitor_ids"
    echo
fi

# Match by unchanging IDs
case "$monitor_ids" in
    "eDP-1 HDMI-A-1")
        screen_profile="lh"
        primary_monitor="HDMI-A-1"
        ;;
    "eDP-1")
        screen_profile="l"
        primary_monitor="eDP-1"
        ;;
    *)
        screen_profile="l"
        primary_monitor="eDP-1"
        ;;
esac

# Match by name when the IDs change
case "$monitor_names" in
    "AOC 22B35HM2 189O8XA000294 Samsung Display Corp. 0x4187 Unknown Samsung Electric Company S22F350 HX5N600217")
        screen_profile="vhl"
        primary_monitor=$(echo -e "$active_monitors" | grep "AOC 22B35HM2 189O8XA000294" | cut -f2)
        secondary_monitor=$(echo -e "$active_monitors" | grep "Samsung Electric Company S22F350 HX5N600217" | cut -f2)
        ;;
esac

if [ "$1" == "-p" ]; then
    echo "Screen profile: $screen_profile"
    echo
    echo "Primary monitor: $primary_monitor"
    echo
    echo "Secondary monitor: $secondary_monitor"
fi
